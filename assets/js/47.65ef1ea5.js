(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{610:function(t,a,s){"use strict";s.r(a);var e=s(5),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"简述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简述"}},[t._v("#")]),t._v(" 简述")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[t._v("在上一篇博客搭建中，我使用了GitHub Actions实现了将博客自动部署发布至GitHub上，但是在使用过一段时间后，发现GitHub访问速度缓慢，特别是最近，如果不适用vpn的话可能访问不了GitHub，所以打算在原有的部署方案中，增加部署至Gitee上，这样国内访问速度便有了保证。")])]),s("p",[t._v("如果你没有看过上一篇内容，请点击"),s("a",{attrs:{href:"https://hahaxiaowai.gitee.io/blogs/Web/vuepress/githubActions.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#步骤"}},[t._v("#")]),t._v(" 步骤")]),t._v(" "),s("p",[t._v("基本原理还是使用GitHub Actions,再部署到GitHub后，新增两个step：")]),t._v(" "),s("ol",[s("li",[t._v("同步代码至gitee")]),t._v(" "),s("li",[t._v("重新部署pages")])]),t._v(" "),s("p",[t._v("第一步我所同步的是编译后的代码，保证仓库代码同步，由于Gitee没有自动更新pages,所以在仓库代码更新后，我们还需要对其进行更新。")]),t._v(" "),s("h3",{attrs:{id:"初始化gitee博客仓库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初始化gitee博客仓库"}},[t._v("#")]),t._v(" 初始化Gitee博客仓库")]),t._v(" "),s("p",[t._v("由于我们要将一份代码部署至两个不同网址下，vuepress的基础路径十分重要，路径不对会导致打包后的静态文件路径不对，在GitHub中，我的基础路径是:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// https://hahaxiaowai.github.io/")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("base")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),s("p",[t._v("所以仓库名称非常重要，在Gitee上依然要保证这样的仓库命名规范：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在GitHub上仓库命名规范")]),t._v("\nyourname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("github"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在Gitee上仓库命名规范")]),t._v("\nyourname\n")])])]),s("p",[t._v("创建时，可以顺便把GitHub仓库的代码拉下来，然后选择 服务>Gitee Pages 配置一下博客并启动，这里不详细展开。")]),t._v(" "),s("h3",{attrs:{id:"增加配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#增加配置"}},[t._v("#")]),t._v(" 增加配置")]),t._v(" "),s("ol",[s("li",[t._v("在Gitee中，点击右上角头像>设置>SSH公钥，同GitHub上一样，设置一个ssh key，这里推荐使用同一个key（BLOG).")]),t._v(" "),s("li",[t._v("在Gitee中，点击右上角头像>设置，进行第三方账号绑定，将微信绑定(我也是拒绝的，但是后面会用到，没有办法)。")]),t._v(" "),s("li",[t._v("在上一篇文章中，我们在源代码 Settings>Secrets 中设置了BlOG变量，这一次我们再增加GITEE变量，变量内容为Gitee的密码，设置好后，我们进入正题，设置Actions.")])]),t._v(" "),s("h3",{attrs:{id:"配置actions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置actions"}},[t._v("#")]),t._v(" 配置Actions")]),t._v(" "),s("p",[t._v("配置文件将省略上一篇文章的配置内容，只将结构留下")]),t._v(" "),s("div",{staticClass:"language-yml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Automatic blog update "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该Action的名字")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# on:何时触发该事件. ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 工作流运行由一个或多个jobs组成，这些job可以按顺序或并行运行")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("jobs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 此工作流包含一个名为“build-deploy”的job。")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build-deploy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# steps表示将作为job一部分执行的一系列任务")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("steps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" actions/checkout@master "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 切换分支到master")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fetch-depth")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Use Node.js 12.x  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#使用nodejs 12.x版本")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" install and build\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("   \n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" deploy "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#部署至GitHub")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("...")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Sync to Gitee "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 同步到Gitee")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" wearerequired/git"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mirror"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@d5724af3876c8fdfdb59312c99df0d11b769ca8c\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("env")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意在 Settings->Secrets 配置 GITEE_RSA_PRIVATE_KEY")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("SSH_PRIVATE_KEY")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.BLOG "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意替换为你的 GitHub 公开仓库地址")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("source-repo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" git@github.com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hahaxiaowai/hahaxiaowai.github.io.git\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意替换为你的 Gitee 目标仓库地址")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("destination-repo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" git@gitee.com"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("hahaxiaowai/hahaxiaowai.git\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" deploy2 "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#部署到gitee")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uses")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" yanglbme/gitee"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("action@v1.3.2\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("with")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deploy_key")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.BLOG "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# key")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitee-username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hahaxiaowai\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitee-password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" secrets.GITEE "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitee-repo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hahaxiaowai/hahaxiaowai "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#推送到该仓库中，地址格式为gitee名称/仓库名")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#分支名")]),t._v("\n       \n")])])]),s("p",[t._v("如果你想了解更多关于这个插件的信息，请点击"),s("a",{attrs:{href:"https://github.com/marketplace/actions/gitee-pages-action",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"注意事项"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),s("p",[t._v("第一次运行时，大概率是失败的，提示你要验证微信登录，如果你提前绑定了微信，应该是没问题的。")])])}),[],!1,null,null,null);a.default=n.exports}}]);