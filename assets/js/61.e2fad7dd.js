(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{474:function(a,t,e){"use strict";e.r(t);var r=e(1),n=Object(r.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h2",{attrs:{id:"简述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简述"}},[a._v("#")]),a._v(" 简述")]),a._v(" "),e("p",[a._v("在使用一段时间lc评论系统后，想起博客一直没有后台评论通知功能，于是查了一些资料，踩了一些坑，终于完善了评论系统。")]),a._v(" "),e("p",[a._v("本文会略过很多过程，只说坑的部分，如果是准备搭建评论系统的同学，按着下面所推荐的官方文档走一遍就OK啦。")]),a._v(" "),e("p",[e("strong",[a._v("非正经教程，仅针对问题给出解决方法。")])]),a._v(" "),e("h2",{attrs:{id:"使用-valine-leancloud"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用-valine-leancloud"}},[a._v("#")]),a._v(" 使用 Valine + leanCloud")]),a._v(" "),e("p",[a._v("此处略，配置Valine的过程:"),e("a",{attrs:{href:"https://vuepress-theme-reco.recoluan.com/views/plugins/comments.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("Valine"),e("OutboundLink")],1),a._v(",看Valine部分就好")]),a._v(" "),e("p",[a._v("创建leanCloud的过程： "),e("a",{attrs:{href:"https://valine.js.org/quickstart.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("leanCloud"),e("OutboundLink")],1)]),a._v(" "),e("p",[a._v("lc分为国际版和国内版，国际版不需要身份证验证，国内需要，其他大差不差了。")]),a._v(" "),e("h2",{attrs:{id:"配置部署valine-admin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置部署valine-admin"}},[a._v("#")]),a._v(" 配置部署Valine-Admin")]),a._v(" "),e("p",[a._v("最后一步，也是坑最多的一步，我的建议是按照这个"),e("a",{attrs:{href:"https://github.com/DesertsP/Valine-Admin",target:"_blank",rel:"noopener noreferrer"}},[a._v("文档"),e("OutboundLink")],1),a._v("自己先来一遍，如果成功没问题了，那么恭喜你，如果中间出现问题，回来看看我的方法是否能够帮到你。")]),a._v(" "),e("h3",{attrs:{id:"_1-smtp-pass-配置邮箱密码-部署后启动报错-smtp邮箱配置异常"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-smtp-pass-配置邮箱密码-部署后启动报错-smtp邮箱配置异常"}},[a._v("#")]),a._v(" 1. SMTP_PASS 配置邮箱密码（部署后启动报错：SMTP邮箱配置异常）")]),a._v(" "),e("p",[a._v("我使用的是QQ邮箱，首先需要给QQ邮箱设置独立密码，之后进入邮箱，选择设置-账号页面")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://hhxy-blog.oss-cn-zhangjiakou.aliyuncs.com/docs/web/leanCloud1.jpg",alt:"leanCloud1"}}),a._v("\n下滑看到下面这个页面，将POP3/SMTP服务打开，手机验证之后，会有一个授权码，将它复制到SMTP_PASS设置中。\n"),e("img",{attrs:{src:"https://hhxy-blog.oss-cn-zhangjiakou.aliyuncs.com/docs/web/leanCloud2.jpg",alt:"leanCloud2"}}),a._v("\n如果是部署后报错，那么设置后重启服务，看看是否报错，如果仍然报错，则手机重新验证，获取新的授权码，再设置一遍。")]),a._v(" "),e("h3",{attrs:{id:"_2-admin-url-二级域名设置-用于自动唤醒"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-admin-url-二级域名设置-用于自动唤醒"}},[a._v("#")]),a._v(" 2. ADMIN_URL 二级域名设置（用于自动唤醒）")]),a._v(" "),e("p",[a._v("官网上这个是选填项，我建议必须填上吧，大多数人都是使用的免费的开发版，自动唤醒还是有必要的。在你绑定域名后，在下方会出现一个lc的二级域名，我们需要设置的就是这个。\n"),e("img",{attrs:{src:"https://hhxy-blog.oss-cn-zhangjiakou.aliyuncs.com/docs/web/leanCloud3.jpg",alt:"leanCloud3"}})]),a._v(" "),e("h3",{attrs:{id:"_3-定时任务时间设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-定时任务时间设置"}},[a._v("#")]),a._v(" 3. 定时任务时间设置")]),a._v(" "),e("p",[a._v("因为使用的是UTC-0 所以将官网教程的两个定时任务改为 0 */30 0-23 * * ?和 0 0 0 * * ?\n但是由于体验版有强制休眠，建议将时间修改为早上9点到晚上22:59")]),a._v(" "),e("h3",{attrs:{id:"_4-博客通知模板"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-博客通知模板"}},[a._v("#")]),a._v(" 4. 博客通知模板")]),a._v(" "),e("p",[a._v("这一步按着官网来就行，需要注意的是，通知博主和通知其他人的模板需要分开设置，"),e("strong",[a._v("里面的环境变量并不相同")]),a._v("。")]),a._v(" "),e("h3",{attrs:{id:"_5-因流控原因"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-因流控原因"}},[a._v("#")]),a._v(" 5. 因流控原因...")]),a._v(" "),e("p",[a._v("体验版lc有强制休眠的设置，24小时内运行了18个小时则会休眠,实测时间更短，无法持续运行18个小时。")]),a._v(" "),e("p",[a._v("实测几天后，发现几遍将定时任务关闭以后，仍然会自启，特别是在凌晨0点到早上八点这段时间，这就导致本该在休眠的时间段运行，正常的时间段又因为流控问题停止运行。或许是我设置（理解）的不对吧。")]),a._v(" "),e("h3",{attrs:{id:"_6-自唤醒任务执行成功-响应状态码为-undefined"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-自唤醒任务执行成功-响应状态码为-undefined"}},[a._v("#")]),a._v(" 6. 自唤醒任务执行成功，响应状态码为: undefined")]),a._v(" "),e("p",[a._v("这句话应该不是报错，目前并未发现会有什么影响，只是返回状态是undefined")]),a._v(" "),e("h2",{attrs:{id:"评论的配置项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#评论的配置项"}},[a._v("#")]),a._v(" 评论的配置项")]),a._v(" "),e("p",[a._v("文章的最后，重新讲一下评论的配置项，其实Valine的评论系统功能还是很丰富的，不过需要我们花时间学习一下评论的配置项，这是"),e("a",{attrs:{href:"https://valine.js.org/configuration.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方API"),e("OutboundLink")],1),a._v("。")]),a._v(" "),e("p",[a._v("在这里推荐几个配置，其他的按需求在官网上找字段吧。")]),a._v(" "),e("ol",[e("li",[a._v("requiredFields 评论是必填的字段（昵称，邮箱，网址），我设置了评论通知，所以必填邮箱")]),a._v(" "),e("li",[a._v("meta 评论可填字段（昵称，邮箱，网址），我设置了昵称和邮箱，将网址去掉了")]),a._v(" "),e("li",[a._v("emojiCDN 表情来源 有需求可以改成其他的（如B站）,不过要相应的设置emojiMaps")])]),a._v(" "),e("p",[a._v("建议将官方文档读一下，还可以"),e("a",{attrs:{href:"https://valine.js.org/avatar.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("设置评论的头像"),e("OutboundLink")],1),a._v("，\n如果有想用B站表情的，请参考"),e("a",{attrs:{href:"https://github.com/hahaxiaowai/bilbilEmoji",target:"_blank",rel:"noopener noreferrer"}},[a._v("这个仓库"),e("OutboundLink")],1),a._v(",里面有不同主题的B站表情包，以及相应的配置博客的keyValue文件。")]),a._v(" "),e("p",[a._v("如果想体验一下这套评论系统，欢迎到我的博客来尝试~")])])}),[],!1,null,null,null);t.default=n.exports}}]);